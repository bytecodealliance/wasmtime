test compile precise-output
target x86_64

; The x86_64 system_v call conv respects uext and sext
function u0:0(i8) system_v {
    sig0 = (i8 uext) system_v
    fn0 = u0:0 sig0

block0(v0: i8):
    call fn0(v0)
    return
}

; VCode:
;   pushq %rbp
;   movq %rsp, %rbp
; block0:
;   movzbq %dil, %rdi
;   load_ext_name userextname0+0, %rsi
;   call    *%rsi
;   movq %rbp, %rsp
;   popq %rbp
;   retq
;
; Disassembled:
; block0: ; offset 0x0
;   pushq %rbp
;   movq %rsp, %rbp
; block1: ; offset 0x4
;   movzbq %dil, %rdi
;   movabsq $0, %rsi ; reloc_external Abs8 u0:0 0
;   callq *%rsi
;   movq %rbp, %rsp
;   popq %rbp
;   retq

function u0:0(i8) windows_fastcall {
    sig0 = (i8 uext) windows_fastcall
    fn0 = u0:0 sig0

block0(v0: i8):
    call fn0(v0)
    return
}

; VCode:
;   pushq %rbp
;   movq %rsp, %rbp
;   subq $0x30, %rsp
;   movq %rsi, 0x20(%rsp)
; block0:
;   movzbq %cl, %rcx
;   load_ext_name userextname0+0, %rsi
;   call    *%rsi
;   movq 0x20(%rsp), %rsi
;   addq $0x30, %rsp
;   movq %rbp, %rsp
;   popq %rbp
;   retq
;
; Disassembled:
; block0: ; offset 0x0
;   pushq %rbp
;   movq %rsp, %rbp
;   subq $0x30, %rsp
;   movq %rsi, 0x20(%rsp)
; block1: ; offset 0xd
;   movzbq %cl, %rcx
;   movabsq $0, %rsi ; reloc_external Abs8 u0:0 0
;   callq *%rsi
;   movq 0x20(%rsp), %rsi
;   addq $0x30, %rsp
;   movq %rbp, %rsp
;   popq %rbp
;   retq

